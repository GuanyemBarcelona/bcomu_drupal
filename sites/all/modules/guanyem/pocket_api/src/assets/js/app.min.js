angular.module("bcomupocket",["ngRoute","ngSanitize","ngAnimate","infinite-scroll"]).constant("APP_CONFIG",{baseHref:""}).controller("appCtrl",["$attrs","APP_CONFIG",function(t,e){e.baseHref=t.baseHref}]).config(["$httpProvider","$routeProvider",function(t,e){t.defaults.headers.post={"Content-Type":"application/json"};var n="/sites/all/modules/guanyem/pocket_api/src";e.when("/",{templateUrl:n+"/app/components/pages/home.page.html"}).otherwise({redirectTo:"/"})}]),angular.module("bcomupocket").controller("homePageCtrl",["$scope","APP_CONFIG",function(t,e){}]),angular.module("bcomupocket").service("pocketServ",["$http",function(t){var e=this;e.apiEndpoint="/api/pocket",e.getData=function(e,n){t({method:"GET",url:e,headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n)},e.getCount=function(t){e.getData(e.apiEndpoint+"/getcount",t)},e.getList=function(t,n,a){e.getData(e.apiEndpoint+"/getlist/"+t+"/"+n,a)},e.getTags=function(t){e.getData(e.apiEndpoint+"/gettags",t)},e.getTaggedBy=function(t,n){e.getData(e.apiEndpoint+"/gettaggedby/"+t,n)}}]),angular.module("bcomupocket").controller("pocketlistCtrl",["$scope","pocketServ",function(t,e){t.itemsPerPage=24,t.fullList=[],t.ready=!1,t.listLoading=!1,t.minSearchLength=2,t.maxItems=-1,t.tagsList=[],t.currentTag=null,t.loadList=function(){return t.maxItems!=-1?!!angular.isNumber(t.maxItems)&&(t.loadListProcess(),!0):(t.listLoading=!0,void e.getCount(function(e){return 200==e.status&&(t.maxItems=parseInt(e.data),!!angular.isNumber(t.maxItems)&&(t.loadListProcess(),!0))}))},t.loadListProcess=function(){(0==t.fullList.length||t.maxItems>t.fullList.length+t.itemsPerPage)&&(t.listLoading=!0,e.getList(t.itemsPerPage,t.fullList.length,function(e){if(t.listLoading=!1,200==e.status)for(var n in e.data)t.fullList.push(e.data[n])}))},t.chooseTag=function(e){t.fullList=[],t.currentTag!==e?(t.currentTag=e,t.loadTaggedList()):(t.currentTag=null,t.loadListProcess())},t.loadTaggedList=function(){t.listLoading=!0,e.getTaggedBy(t.currentTag,function(e){if(t.listLoading=!1,200==e.status)for(var n in e.data)t.fullList.push(e.data[n])})},t.loadTags=function(){e.getTags(function(e){200==e.status&&(t.tagsList=e.data)})},t.isListEmpty=function(){return 0==t.fullList.length},t.resetSearch=function(){t.searchText=""},t.isThereTextToSearch=function(){return!angular.isUndefined(t.searchText)&&""!=t.searchText&&t.searchText.length>=t.minSearchLength},t.showEmptySearchMessage=function(){return t.isThereTextToSearch()&&0==t.fullList.length}}]),angular.module("bcomupocket").directive("pocketList",["APP_CONFIG",function(t){return{restrict:"E",replace:!0,templateUrl:t.baseHref+"/app/components/pocket/pocketlist.directive.html",controller:"pocketlistCtrl",scope:{}}}]),angular.module("bcomupocket").directive("pocketListItem",["APP_CONFIG",function(t){return{restrict:"E",replace:!0,templateUrl:t.baseHref+"/app/components/pocket/pocketlistitem.directive.html"}}]),angular.module("bcomupocket").directive("tagFiltersList",["APP_CONFIG",function(t){return{restrict:"E",replace:!0,templateUrl:t.baseHref+"/app/components/pocket/tagfilterslist.directive.html",link:function(t,e,n){t.loadTags()}}}]),angular.module("bcomupocket").directive("externalLink",function(){return{restrict:"A",link:function(t,e){e.attr("target","_blank")}}}),angular.module("bcomupocket").directive("fadeOnload",function(){return{restrict:"A",link:function(t,e,n){e.addClass("image-fader"),e.addClass("ng-hide-remove"),e.on("load",function(t){e.addClass("ng-hide-add")})}}});